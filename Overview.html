<!DOCTYPE html><html lang="en-US"><meta charset="utf-8">
<link href="//whatwg.org/style/specification" rel="stylesheet">
<link href="//resources.whatwg.org/logo-notifications.svg" rel="icon">
<title>Notifications API Standard</title>

<div class="head">

<p><a class="logo" href="//whatwg.org/"><img alt="WHATWG" height="100" src="//resources.whatwg.org/logo-notifications.svg" width="100"></a></p>
<h1>Notifications API</h1>
<h2 class="no-num no-toc" id="living-standard-—-last-updated-6-october-2014">Living Standard — Last Updated 6 October 2014</h2>

<dl>
 <dt>Participate:</dt>
 <dd>Send feedback to <a href="//whatwg.org/mailing-list">whatwg@whatwg.org</a>
 (<a href="http://lists.w3.org/Archives/Public/public-whatwg-archive/">archives</a>)
 or <a href="https://github.com/whatwg/notifications/issues/new">file an issue</a>
 (<a href="https://github.com/whatwg/notifications/issues">open issues</a>)
 <dd><a href="//wiki.whatwg.org/wiki/IRC">IRC: #whatwg on Freenode</a>

 <dt>Version History:
 <dd><a href="https://github.com/whatwg/notifications/commits">https://github.com/whatwg/notifications/commits</a>
</dl>

</div>



<h2 class="no-num no-toc" id="table-of-contents">Table of contents</h2>


<!--begin-toc-->
<ol class="toc">
 <li><a href="#preface"><span class="secno">1 </span>Preface</a></li>
 <li><a href="#conformance"><span class="secno">2 </span>Conformance</a></li>
 <li><a href="#terminology"><span class="secno">3 </span>Terminology</a></li>
 <li><a href="#model"><span class="secno">4 </span>Model</a>
  <ol>
   <li><a href="#direction-0"><span class="secno">4.1 </span>Direction</a></li>
   <li><a href="#language-0"><span class="secno">4.2 </span>Language</a></li>
   <li><a href="#permission"><span class="secno">4.3 </span>Permission</a></li>
   <li><a href="#notification-list"><span class="secno">4.4 </span>Notification list</a></li>
   <li><a href="#showing-a-notification"><span class="secno">4.5 </span>Showing a notification</a></li>
   <li><a href="#activating-a-notification"><span class="secno">4.6 </span>Activating a notification</a></li>
   <li><a href="#closing-a-notification"><span class="secno">4.7 </span>Closing a notification</a></li>
   <li><a href="#displaying-notifications"><span class="secno">4.8 </span>Displaying notifications</a></li>
   <li><a href="#replacing-a-notification"><span class="secno">4.9 </span>Replacing a notification</a></ol></li>
 <li><a href="#api"><span class="secno">5 </span>API</a>
  <ol>
   <li><a href="#garbage-collection"><span class="secno">5.1 </span>Garbage collection</a></li>
   <li><a href="#constructors"><span class="secno">5.2 </span>Constructors</a></li>
   <li><a href="#static-members"><span class="secno">5.3 </span>Static members</a></li>
   <li><a href="#object-members"><span class="secno">5.4 </span>Object members</a></li>
   <li><a href="#examples"><span class="secno">5.5 </span>Examples</a>
    <ol>
     <li><a href="#using-events"><span class="secno">5.5.1 </span>Using events</a></li>
     <li><a href="#tags-example"><span class="secno">5.5.2 </span>Using the <code title="">tag</code> member for multiple instances</a></li>
     <li><a href="#using-the-tag-member-for-a-single-instance"><span class="secno">5.5.3 </span>Using the <code title="">tag</code> member for a single instance</a></ol></ol></li>
 <li><a href="#service-worker-api"><span class="secno">6 </span>Service worker API</a></li>
 <li><a class="no-num" href="#references">References</a></li>
 <li><a class="no-num" href="#acknowledgments">Acknowledgments</a></ol>
<!--end-toc-->



<h2 id="preface"><span class="secno">1 </span>Preface</h2>

<p>This standard defines an API to display notifications to the end user, typically
outside the top-level browsing context's viewport. It is designed to be compatible with
existing notification systems, while remaining platform-independent.



<h2 id="conformance"><span class="secno">2 </span>Conformance</h2>

<p>All diagrams, examples, and notes in this specification are
non-normative, as are all sections explicitly marked non-normative.
Everything else in this specification is normative.

<p>The key words "MUST", "MUST NOT", "REQUIRED", <!--"SHALL", "SHALL
NOT",--> "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
"OPTIONAL" in the normative parts of this specification are to be
interpreted as described in RFC2119. For readability, these words do
not appear in all uppercase letters in this specification.
<a href="#refsRFC2119">[RFC2119]</a>



<h2 id="terminology"><span class="secno">3 </span>Terminology</h2>

<p>Most terminology used in this specification is from DOM, Fetch HTML, IDL, and URL.
<a href="#refsDOM">[DOM]</a>
<a href="#refsFETCH">[FETCH]</a>
<a href="#refsHTML">[HTML]</a>
<a href="#refsWEBIDL">[WEBIDL]</a>
<a href="#refsURL">[URL]</a>



<h2 id="model"><span class="secno">4 </span>Model</h2>

<p>A <dfn id="concept-notification" title="concept-notification">notification</dfn> is an abstract representation of
an occurrence, such as the delivery of a message.

<p>Each <a href="#concept-notification" title="concept-notification">notification</a> has a
<dfn id="title">title</dfn>, <dfn id="body">body</dfn>, <dfn id="direction">direction</dfn>,
<dfn id="language">language</dfn>, <dfn id="tag">tag</dfn>, <dfn id="data">data</dfn>, and an
<dfn id="concept-notification-origin" title="concept-notification-origin">origin</dfn>.

<p>Each <a href="#concept-notification" title="concept-notification">notification</a> <em>can</em>
have an associated <dfn id="icon-url">icon URL</dfn> and <dfn id="icon-image">icon image</dfn>.


<h3 id="direction-0"><span class="secno">4.1 </span>Direction</h3>

<p>This section is written in terms equivalent to those used in the
Rendering section of HTML. <a href="#refsHTML">[HTML]</a>

<!-- keep this in sync with
     https://html.spec.whatwg.org/multipage/rendering.html#text-rendered-in-native-user-interfaces -->

<p>User agents are expected to honor the Unicode semantics of the text of a
<a href="#concept-notification" title="concept-notification">notification</a>'s <a href="#title">title</a>
and <a href="#body">body</a>. Each is expected to be treated as an independent set
of one or more bidirectional algorithm paragraphs when displayed, as defined
by the bidirectional algorithm's rules P1, P2, and P3, including, for
instance, supporting the paragraph-breaking behaviour of
U+000A LINE FEED (LF) characters. For each paragraph of the
<a href="#title">title</a> and <a href="#body">body</a>, the
<a href="#concept-notification" title="concept-notification">notification</a>'s
<a href="#direction">direction</a> provides the higher-level override of rules P2 and P3
if it has a value other than "<code title="">auto</code>".
<a href="#refsBIDI">[BIDI]</a>


<h3 id="language-0"><span class="secno">4.2 </span>Language</h3>

<!-- keep this in sync with
     https://html.spec.whatwg.org/multipage/dom.html#attr-lang -->

<p>The <a href="#concept-notification" title="concept-notification">notification</a>'s
<a href="#language">language</a> specifies the primary language for the
<a href="#concept-notification" title="concept-notification">notification</a>'s <a href="#title">title</a>
and <a href="#body">body</a>. Its value is a valid BCP 47 language tag, or the
empty string. The empty string indicates that the primary language is
unknown. <a href="#refsLANG">[LANG]</a>


<h3 id="permission"><span class="secno">4.3 </span>Permission</h3>

<p><a href="#concept-notification" title="concept-notification">Notifications</a> can only be
displayed if the user (or user agent on behalf of the user) has granted
<dfn id="permission-0">permission</dfn>. The <a href="#permission-0">permission</a> to display
<a href="#concept-notification" title="concept-notification">notifications</a> for a given
<a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/browsers.html#origin">origin</a> can be one of three strings:

<dl>
 <dt>"<code title="">default</code>"
 <dd><p>This is equivalent to "<code title="">denied</code>", but the user has
 made no explicit choice thus far.

 <dt>"<code title="">denied</code>"
 <dd><p>This means the user does not want
 <a href="#concept-notification" title="concept-notification">notifications</a>.

 <dt>"<code title="">granted</code>"
 <dd><p>This means <a href="#concept-notification" title="concept-notification">notifications</a> can
 be displayed.
</dl>

<p class="note">There is no equivalent to "<code title="">default</code>"
meaning "<code title="">granted</code>". In that case
"<code title="">granted</code>" is simply returned as there would be no reason
for the application to ask for <a href="#permission-0">permission</a>.


<h3 id="notification-list"><span class="secno">4.4 </span>Notification list</h3>

<p>The user agent must keep a <dfn id="list-of-notifications">list of notifications</dfn>. User agents are
recommended to persist the lifetime of these lists beyond that of the
<a href="#notification"><code>Notification</code></a> object through which the <a href="#concept-notification" title="concept-notification">notification</a> was created.

<p class="warning">The <a href="#list-of-notifications">list of notifications</a> and cookies have similar
implications with respect to privacy (e.g. these lists can be used to revive cookies).
Implementors are therefore encouraged to expose these lists in a manner related to HTTP
cookies, allowing them to be expunged together with cookies and other origin-specific
data.

<!-- XXX https://html.spec.whatwg.org/#fingerprinting-vector -->


<h3 id="showing-a-notification"><span class="secno">4.5 </span>Showing a notification</h3>

<p>The <dfn id="show-steps">show steps</dfn> for a given
<a href="#concept-notification" title="concept-notification">notification</a> <var title="">notification</var> are:

<ol>
 <li><p>If <a href="#permission-0">permission</a> for <var title="">notification</var>'s
 <a href="#concept-notification-origin" title="concept-notification-origin">origin</a> is not
 "<code title="">granted</code>",
 <a class="external" data-anolis-spec="fetch" href="https://fetch.spec.whatwg.org/#concept-fetch-terminate" title="concept-fetch-terminate">terminate</a> any ongoing
 <a class="external" data-anolis-spec="fetch" href="https://fetch.spec.whatwg.org/#concept-fetch" title="concept-fetch">fetch</a> for
 <var title="">notification</var>'s <a href="#icon-url">icon URL</a>, then for each
 <a href="#notification"><code>Notification</code></a> object representing <var title="">notification</var>,
 <a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a> to
 <a class="external" data-anolis-spec="dom" href="https://dom.spec.whatwg.org/#concept-event-fire" title="concept-event-fire">fire an event</a>
 named <code title="">error</code> on the <a href="#notification"><code>Notification</code></a> object, and
 terminate these steps.

 <li><p>If there is a <a href="#concept-notification" title="concept-notification">notification</a>
 in the <a href="#list-of-notifications">list of notifications</a> whose <a href="#tag">tag</a> is not the empty
 string and equals <var title="">notification</var>'s <a href="#tag">tag</a>, and whose
 <a href="#concept-notification-origin" title="concept-notification-origin">origin</a> equals
 <var title="">notification</var>'s <a href="#concept-notification-origin" title="concept-notification-origin">origin</a>,
 run the <a href="#replace-steps">replace steps</a> for that
 <a href="#concept-notification" title="concept-notification">notification</a> and
 <var title="">notification</var>, and then terminate these steps.

 <li><p>Run the <a href="#display-steps">display steps</a> for <var title="">notification</var> and terminate these steps.
</ol>

<h3 id="activating-a-notification"><span class="secno">4.6 </span>Activating a notification</h3>

<p>When a <a href="#concept-notification" title="concept-notification">notification</a>
<var title="">notification</var> is activated by the user, assuming the underlying
notification platform supports activation, the user agent must, for each
<a href="#notification"><code>Notification</code></a> object representing <var title="">notification</var>,
<a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a> to
<a class="external" data-anolis-spec="dom" href="https://dom.spec.whatwg.org/#concept-event-fire" title="concept-event-fire">fire an event</a>
named <code title="">click</code> on the <a href="#notification"><code>Notification</code></a> object.

<p class="note">Throughout the web platform "activate" is intentionally misnamed as "click".

<p class="note no-backref">When user agents do not automatically focus a
<a href="#concept-notification" title="concept-notification">notification</a>'s related
<a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context">browsing context</a>, they are encouraged to make
<a href="https://html.spec.whatwg.org/multipage/interaction.html#dom-window-focus"><code class="external" data-anolis-spec="html" title="dom-window-focus">window.focus()</code></a> work from within
the event listener for the event named <code title="">click</code>.

<h3 id="closing-a-notification"><span class="secno">4.7 </span>Closing a notification</h3>

<p>When a <a href="#concept-notification" title="concept-notification">notification</a> is closed,
either by the underlying notification platform or by the user, the
<a href="#close-steps">close steps</a> for it must be run.

<p>The <dfn id="close-steps">close steps</dfn> for a given <var title="">notification</var> are:

<ol>
 <li><p>If <var title="">notification</var> is not in the
 <a href="#list-of-notifications">list of notifications</a>, terminate these steps.

 <li><p>Remove <var title="">notification</var> from the
 <a href="#list-of-notifications">list of notifications</a> and then for each <a href="#notification"><code>Notification</code></a>
 object representing <var title="">notification</var>,
 <a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a> to
 <a class="external" data-anolis-spec="dom" href="https://dom.spec.whatwg.org/#concept-event-fire" title="concept-event-fire">fire an event</a>
 named <code title="">close</code> on the <a href="#notification"><code>Notification</code></a> object.
</ol>

<h3 id="displaying-notifications"><span class="secno">4.8 </span>Displaying notifications</h3>

<p>The <dfn id="display-steps">display steps</dfn> for a given <var title="">notification</var>
are:

<ol>
 <li>
  <!-- XXX replace with https://www.w3.org/Bugs/Public/show_bug.cgi?id=24055 -->
  <p>If the notification platform supports icons,
  <var title="">notification</var>'s <a href="#icon-url">icon URL</a> is set and has not
  yet been <a class="external" data-anolis-spec="fetch" href="https://fetch.spec.whatwg.org/#concept-fetch" title="concept-fetch">fetched</a>,
  <a class="external" data-anolis-spec="fetch" href="https://fetch.spec.whatwg.org/#concept-fetch" title="concept-fetch">fetch</a> it and wait for the
  <a class="external" data-anolis-spec="fetch" href="https://fetch.spec.whatwg.org/#concept-response" title="concept-response">response</a>.

  <p>If the <a class="external" data-anolis-spec="fetch" href="https://fetch.spec.whatwg.org/#concept-response" title="concept-response">response</a>'s
  <a class="external" data-anolis-spec="fetch" href="https://fetch.spec.whatwg.org/#concept-internal-response" title="concept-internal-response">internal response</a>'s
  <a class="external" data-anolis-spec="fetch" href="https://fetch.spec.whatwg.org/#concept-response-type" title="concept-response-type">type</a> is
  <i title="">default</i>, attempt to decode the resource as image.

  <p>Once <a class="external" data-anolis-spec="fetch" href="https://fetch.spec.whatwg.org/#concept-fetch" title="concept-fetch">fetching</a> has
  finished and the image format is supported, set
  <var title="">notification</var>'s <a href="#icon-image">icon image</a> to the decoded resource.
  (Otherwise <var title="">notification</var> has no <a href="#icon-image">icon image</a>.)

 <li><p>Display <var title="">notification</var> on the device (e.g. by
 calling the appropriate notification platform).

 <li><p>If displaying fails (e.g. the notification platform returns an error), for
 each <a href="#notification"><code>Notification</code></a> object representing <var title="">notification</var>,
 <a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a> to
 <a class="external" data-anolis-spec="dom" href="https://dom.spec.whatwg.org/#concept-event-fire" title="concept-event-fire">fire an event</a> named
 <code title="">error</code> on the <a href="#notification"><code>Notification</code></a> object and terminate these
 steps.

 <li><p>Append <var title="">notification</var> to the
 <a href="#list-of-notifications">list of notifications</a>.
</ol>


<h3 id="replacing-a-notification"><span class="secno">4.9 </span>Replacing a notification</h3>

<p>The <dfn id="replace-steps">replace steps</dfn> for replacing an <var title="">old</var>
<a href="#concept-notification" title="concept-notification">notification</a> with a
<var title="">new</var> one are:

<ol>
 <li>
  <!-- XXX replace with https://www.w3.org/Bugs/Public/show_bug.cgi?id=24055 -->
  <p>If the notification platform supports icons,
  <var title="">new</var>'s <a href="#icon-url">icon URL</a> is set and has not
  yet been <a class="external" data-anolis-spec="fetch" href="https://fetch.spec.whatwg.org/#concept-fetch" title="concept-fetch">fetched</a>,
  <a class="external" data-anolis-spec="fetch" href="https://fetch.spec.whatwg.org/#concept-fetch" title="concept-fetch">fetch</a> it and wait for the
  <a class="external" data-anolis-spec="fetch" href="https://fetch.spec.whatwg.org/#concept-response" title="concept-response">response</a>.

  <p>If the <a class="external" data-anolis-spec="fetch" href="https://fetch.spec.whatwg.org/#concept-response" title="concept-response">response</a>'s
  <a class="external" data-anolis-spec="fetch" href="https://fetch.spec.whatwg.org/#concept-internal-response" title="concept-internal-response">internal response</a>'s
  <a class="external" data-anolis-spec="fetch" href="https://fetch.spec.whatwg.org/#concept-response-type" title="concept-response-type">type</a> is
  <i title="">default</i>, attempt to decode the resource as image.

  <p>Once <a class="external" data-anolis-spec="fetch" href="https://fetch.spec.whatwg.org/#concept-fetch" title="concept-fetch">fetching</a> has
  finished and the image format is supported, set
  <var title="">new</var>'s <a href="#icon-image">icon image</a> to the decoded resource.
  (Otherwise <var title="">new</var> has no <a href="#icon-image">icon image</a>.)

 <li>
  <p>Replace <var title="">old</var> with <var title="">new</var>,
  in the same position, in the <a href="#list-of-notifications">list of notifications</a>, then
  for each <a href="#notification"><code>Notification</code></a> object representing <var title="">old</var>,
  <a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a> to
  <a class="external" data-anolis-spec="dom" href="https://dom.spec.whatwg.org/#concept-event-fire" title="concept-event-fire">fire an event</a>
  named <code title="">close</code> on the <a href="#notification"><code>Notification</code></a> object.

  <p>If the notification platform does not support replacement this
  requirement may be addressed by running the <a href="#close-steps">close steps</a> for
  <var title="">old</var> and then running the <a href="#display-steps">display steps</a> for
  <var title="">new</var>.

  <p class="note">Notification platforms are strongly encouraged to support
  native replacement. It is much nicer.
</ol>



<h2 id="api"><span class="secno">5 </span>API</h2>

<p>A <a href="#concept-notification" title="concept-notification">notification</a> is represented by zero or more
<a href="#notification"><code>Notification</code></a> objects and can be created by
<a href="#notification"><code>Notification</code></a>'s <a href="#dom-notification" title="dom-Notification">constructor</a>.

<pre class="idl">[<a href="#dom-notification" title="dom-Notification">Constructor</a>(DOMString <var title="">title</var>, optional <a href="#notificationoptions">NotificationOptions</a> <var title="">options</var>),
 Exposed=(Window,Worker)]
interface <dfn id="notification">Notification</dfn> : <a class="external" data-anolis-spec="dom" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a> {
  static readonly attribute <a href="#notificationpermission">NotificationPermission</a> <a href="#dom-notification-permission" title="dom-Notification-permission">permission</a>;
  [Exposed=Window] static void <a href="#dom-notification-requestpermission" title="dom-Notification-requestPermission">requestPermission</a>(optional <a href="#notificationpermissioncallback">NotificationPermissionCallback</a> <var title="">callback</var>);

  attribute <a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a href="#handler-onclick" title="handler-onclick">onclick</a>;
  attribute <a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a href="#handler-onerror" title="handler-onerror">onerror</a>;
  attribute <a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a href="#handler-onclose" title="handler-onclose">onclose</a>;

  readonly attribute DOMString <a href="#dom-notification-title" title="dom-Notification-title">title</a>;
  readonly attribute <a href="#notificationdirection">NotificationDirection</a> <a href="#dom-notification-dir" title="dom-Notification-dir">dir</a>;
  readonly attribute DOMString <a href="#dom-notification-lang" title="dom-Notification-lang">lang</a>;
  readonly attribute DOMString <a href="#dom-notification-body" title="dom-Notification-body">body</a>;
  readonly attribute DOMString <a href="#dom-notification-tag" title="dom-Notification-tag">tag</a>;
  readonly attribute DOMString <a href="#dom-notification-icon" title="dom-Notification-icon">icon</a>;
  [SameObject] readonly attribute any <a href="#dom-notification-data" title="dom-Notification-data">data</a>;

  void <a href="#dom-notification-close" title="dom-Notification-close">close</a>();
};

dictionary <dfn id="notificationoptions">NotificationOptions</dfn> {
  <a href="#notificationdirection">NotificationDirection</a> dir = "auto";
  DOMString lang = "";
  DOMString body = "";
  DOMString tag = "";
  DOMString icon;
  any data = null;
};

enum <dfn id="notificationpermission">NotificationPermission</dfn> {
  "default",
  "denied",
  "granted"
};

callback <dfn id="notificationpermissioncallback">NotificationPermissionCallback</dfn> = void (<a href="#notificationpermission">NotificationPermission</a> <var title="">permission</var>);

enum <dfn id="notificationdirection">NotificationDirection</dfn> {
  "auto",
  "ltr",
  "rtl"
};</pre>


<h3 id="garbage-collection"><span class="secno">5.1 </span>Garbage collection</h3>

<p>A <a href="#notification"><code>Notification</code></a> object must not be garbage collected while its
corresponding <a href="#concept-notification" title="concept-notification">notification</a> is in the
<a href="#list-of-notifications">list of notifications</a> and the <a href="#notification"><code>Notification</code></a> object in
question has an
<a class="external" data-anolis-spec="dom" href="https://dom.spec.whatwg.org/#concept-event-listener" title="concept-event-listener">event listener</a> whose
<b>type</b> is <code title="">click</code>, <code title="">error</code> or
<code title="">close</code>.


<h3 id="constructors"><span class="secno">5.2 </span>Constructors</h3>

<p>The
<dfn id="dom-notification" title="dom-Notification"><code>Notification(<var title="">title</var>, <var title="">options</var>)</code></dfn>
constructor must run these steps:

<ol>
 <li><p>Let <var title="">notification</var> be a new
 <a href="#concept-notification" title="concept-notification">notification</a> represented by a
 <a href="#notification"><code>Notification</code></a> object.

 <li><p>Set <var title="">notification</var>'s <a href="#title">title</a> to
 <var title="">title</var>.

 <li><p>Set <var title="">notification</var>'s <a href="#direction">direction</a> to
 <var title="">options</var>'s <code title="">dir</code>.

 <li><p>If <var title="">options</var>'s <code title="">lang</code> is a valid
 BCP 47 language tag, or the empty string, set
 <var title="">notification</var>'s <a href="#language">language</a> to
 <var title="">options</var>'s <code title="">lang</code>, or set it to the empty
 string otherwise. <a href="#refsLANG">[LANG]</a>

 <li><p>Set <var title="">notifications</var>'s
 <a href="#concept-notification-origin" title="concept-notification-origin">origin</a> to the
 <a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/webappapis.html#entry-settings-object">entry settings object</a>'s
 <a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/browsers.html#origin">origin</a>.

 <li><p>Set <var title="">notification</var>'s <a href="#body">body</a> to
 <var title="">options</var>'s <code title="">body</code>.

 <li><p>Set <var title="">notification</var>'s <a href="#tag">tag</a> to
 <var title="">options</var>'s <code title="">tag</code>.

 <li><p>If <var title="">options</var>'s <code title="">icon</code> is present,
 <a class="external" data-anolis-spec="url" href="https://url.spec.whatwg.org/#concept-url-parser" title="concept-url-parser">parse</a>
 <code title="">icon</code> using the <a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/webappapis.html#api-base-url">API base URL</a>
 specified by the <a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/webappapis.html#entry-settings-object">entry settings object</a>, and if that
 does not return failure, set <var title="">notification</var>'s <a href="#icon-url">icon URL</a> to the
 return value. (Otherwise <a href="#icon-url">icon URL</a> is not set.)

 <li><p>Set <var title="">notification</var>'s <a href="#data">data</a> to a
 <a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/infrastructure.html#structured-clone">structured clone</a> of
 <var title="">options</var>'s <code title="">data</code>. Rethrow any exceptions.

 <li><p>Return <var title="">notification</var>, but continue running these
 steps asynchronouusly.

 <li><p>If the notification platform supports icons, the user agent may
 start <a class="external" data-anolis-spec="fetch" href="https://fetch.spec.whatwg.org/#concept-fetch" title="concept-fetch">fetching</a>
 <var title="">notification</var>'s <a href="#icon-url">icon URL</a> at this point, if
 <a href="#icon-url">icon URL</a> is set.

 <li><p>Run the <a href="#show-steps">show steps</a> for <var title="">notification</var>.
</ol>


<h3 id="static-members"><span class="secno">5.3 </span>Static members</h3>

<p>The static <dfn id="dom-notification-permission" title="dom-Notification-permission"><code>permission</code></dfn>
attribute's getter must return <a href="#permission-0">permission</a>.

<p>The static
<dfn id="dom-notification-requestpermission" title="dom-Notification-requestPermission"><code>requestPermission(<var title="">callback</var>)</code></dfn>
method, when invoked, must run these steps:

<ol>
 <li><p>Return, but continue running these steps asynchronously.

 <li><p>Let <var title="">permission</var> be <a href="#permission-0">permission</a>.

 <li><p>If <var title="">permission</var> is "<code title="">default</code>", ask the user
 whether showing notifications for the
 <a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/webappapis.html#entry-settings-object">entry settings object</a>'s
 <a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/browsers.html#origin">origin</a> is acceptable. If it is, set
 <var title="">permission</var> to "<code title="">granted</code>", and
 "<code title="">denied</code>" otherwise.

 <li><p><a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to set
 <a href="#permission-0">permission</a> to <var title="">permission</var> and invoke
 <var title="">callback</var> with <var title="">permission</var> as single
 argument if <var title="">callback</var> is given.
</ol>

<p class="warning">In designing the platform notifications are the one
instance thus far where asking the user upfront makes sense. Specifications
for other APIs should not use this pattern and instead employ one of the
<a href="http://robert.ocallahan.org/2011/06/permissions-for-web-applications_30.html">many more suitable alternatives</a>.



<h3 id="object-members"><span class="secno">5.4 </span>Object members</h3>

<p>The following are the <a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers">event handlers</a>
(and their corresponding
<a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type" title="event handler event type">event handler event types</a>)
that must be supported as attributes by the <a href="#notification"><code>Notification</code></a> object.

<table>
 <thead>
  <tr>
   <th><a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers" title="event handlers">event handler</a>
   <th><a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type">event handler event type</a>
 <tbody>
  <tr>
   <td><dfn id="handler-onclick" title="handler-onclick"><code>onclick</code></dfn>
   <td><code title="event-click">click</code>
  <tr>
   <td><dfn id="handler-onerror" title="handler-onerror"><code>onerror</code></dfn>
   <td><code title="event-error">error</code>
  <tr>
   <td><dfn id="handler-onclose" title="handler-onclose"><code>onclose</code></dfn>
   <td><code title="event-close">close</code>
</table>

<p>The <dfn id="dom-notification-close" title="dom-Notification-close"><code>close()</code></dfn> method, when invoked,
must run the <a href="#close-steps">close steps</a> for the
<a href="#concept-notification" title="concept-notification">notification</a>.

<p>The <dfn id="dom-notification-title" title="dom-Notification-title"><code>title</code></dfn> attribute's getter must
return the <a href="#concept-notification" title="concept-notification">notification</a>'s <a href="#title">title</a>.

<p>The <dfn id="dom-notification-dir" title="dom-Notification-dir"><code>dir</code></dfn> attribute's getter must
return the <a href="#concept-notification" title="concept-notification">notification</a>'s <a href="#direction">direction</a>.

<p>The <dfn id="dom-notification-lang" title="dom-Notification-lang"><code>lang</code></dfn> attribute's getter must
return the <a href="#concept-notification" title="concept-notification">notification</a>'s <a href="#language">language</a>.

<p>The <dfn id="dom-notification-body" title="dom-Notification-body"><code>body</code></dfn> attribute's getter must
return the <a href="#concept-notification" title="concept-notification">notification</a>'s <a href="#body">body</a>.

<p>The <dfn id="dom-notification-tag" title="dom-Notification-tag"><code>tag</code></dfn> attribute's getter must
return the <a href="#concept-notification" title="concept-notification">notification</a>'s <a href="#tag">tag</a>.

<p>The <dfn id="dom-notification-icon" title="dom-Notification-icon"><code>icon</code></dfn> attribute's getter must
return the <a href="#concept-notification" title="concept-notification">notification</a>'s <a href="#icon-url">icon URL</a>,
<a class="external" data-anolis-spec="url" href="https://url.spec.whatwg.org/#concept-url-serializer" title="concept-url-serializer">serialized</a>, and the
empty string if there is no <a href="#concept-notification" title="concept-notification">notification</a>'s
<a href="#icon-url">icon URL</a> otherwise.

<p>The <dfn id="dom-notification-data" title="dom-Notification-data"><code>data</code></dfn> attribute's getter must
return a <a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/infrastructure.html#structured-clone">structured clone</a> of
<a href="#concept-notification" title="concept-notification">notification</a>'s <a href="#data">data</a>.


<h3 id="examples"><span class="secno">5.5 </span>Examples</h3>

<h4 id="using-events"><span class="secno">5.5.1 </span>Using events</h4>

<p><a href="#notification"><code>Notification</code></a> objects dispatch events during their lifecycle,
which developers can use to generate desired behaviors.

<p>The <code title="event-close">close</code> event dispatches when the
notification is dismissed by the user. Developers may use this event to
perform actions when notifications are acknowledged.

<p>In the following example, when a meeting reminder notification is
acknowledged, the application suppresses other forms of reminders.

<pre class="example">var notification = new Notification("Meeting about to begin", { icon: "calendar.gif", body: "Room 101" })
notification.onclose = function(event) { cancelReminders(event) }</pre>


<h4 id="tags-example"><span class="secno">5.5.2 </span>Using the <code title="">tag</code> member for multiple instances</h4>

<p>Web applications frequently operate concurrently in multiple instances, such as when a
	user opens a mail application in multiple browser tabs.  Since the desktop is a shared
	resource, the notifications API provides a way for these instances to easily coordinate, by
	using the <code title="">tag</code> member.

<p>Notifications which represent the same conceptual event can be tagged in the same way,
	and when both are shown, the user will only receive one notification.
      </p>

<pre class="example" title="">Instance 1                                   | Instance 2
                                             |
// Instance notices there is new mail.       |
new Notification("New mail from John Doe",   |
                 { tag: 'message1' });       |
                                             |
                                             |  // Slightly later, this instance notices
                                             |  // there is new mail.
                                             |  new Notification("New mail from John Doe",
                                             |                   { tag: 'message1' });</pre>

<p>
	The result of this situation, if the user agent follows the algorithms here, is a <strong>single</strong> notification "New mail from John Doe".

<h4 id="using-the-tag-member-for-a-single-instance"><span class="secno">5.5.3 </span>Using the <code title="">tag</code> member for a single instance</h4>

<p>The <code title="">tag</code> member can also be used by a single instance of an application to keep its
	notifications as current as possible as state changes.

<p>For example, if Alice is using a chat application with Bob, and Bob sends multiple
	messages while Alice is idle, the application may prefer that Alice not see a
	desktop notification for each message.

<pre class="example">// Bob says "Hi"
new Notification("Bob: Hi", { tag: 'chat_Bob' });

// Bob says "Are you free this afternoon?"
new Notification("Bob: Hi / Are you free this afternoon?", { tag: 'chat_Bob' });</pre>

<p>The result of this situation is a <em>single</em> notification; the second one
	replaces the first having the same tag.  In a platform that queues notifications
	(first-in-first-out), using the tag allows the notification to also maintain its
	position in the queue.  Platforms where the newest notifications are shown first,
	a similar result could be achieved using the
	<a href="#dom-notification-close"><code title="dom-Notification-close">close()</code></a> method.



<h2 id="service-worker-api"><span class="secno">6 </span>Service worker API</h2>

<pre class="idl">partial interface <a href="#notification">Notification</a> {
  [Exposed=ServiceWorker] static Promise&lt;sequence&lt;<a href="#notification">Notification</a>&gt;&gt; <a href="#dom-notification-get" title="dom-Notification-get">get</a>(optional <a href="#getnotificationoptions">GetNotificationOptions</a> <var title="">filter</var>);
};

dictionary <dfn id="getnotificationoptions">GetNotificationOptions</dfn> {
  DOMString tag = "";
};

partial interface <a class="external" data-anolis-spec="sw" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/#service-worker-registration-interface">ServiceWorkerRegistration</a> {
  Promise&lt;void&gt; <span title="dom-ServiceWorkerRegistration-showNotification">showNotification</span>(DOMString <var title="">title</var>, optional <a href="#notificationoptions">NotificationOptions</a> <var>options</var>);
};

[<a class="external" data-anolis-spec="dom" href="https://dom.spec.whatwg.org/#concept-event-constructor" title="concept-event-constructor">Constructor</a>(DOMString <var>type</var>, optional <a href="#serviceworkernotificationeventinit">ServiceWorkerNotificationEventInit</a> <var>eventInitDict</var>),
 Exposed=ServiceWorker]
interface <dfn id="serviceworkernotificationevent">ServiceWorkerNotificationEvent</dfn> : <a class="external" data-anolis-spec="dom" href="https://dom.spec.whatwg.org/#event">Event</a> {
  readonly attribute <a href="#notification">Notification</a> <span title="dom-ServiceWorkerNotificationEvent-notification">notification</span>;
};

dictionary <dfn id="serviceworkernotificationeventinit">ServiceWorkerNotificationEventInit</dfn> : <a class="external" data-anolis-spec="dom" href="https://dom.spec.whatwg.org/#eventinit">EventInit</a> {
  required <a href="#notification">Notification</a> notification;
};</pre>

<p>The static
<dfn id="dom-notification-get" title="dom-Notification-get"><code>get(<var title="">filter</var>)</code></dfn> method,
when invoked, must run these steps:

<ol>
 <li><p>Let <var title="">promise</var> be a new promise.

 <li><p>Return <var title="">promise</var> and continue running the remaining steps
 asynchronously.
 <!-- XXX use in parallel -->

 <li><p>Let <var title="">tag</var> be <var title="">filter</var>'s <code title="">tag</code>.

 <li><p>Let <var title="">notifications</var> be a list of all
 <a href="#concept-notification" title="concept-notification">notifications</a> in the
 <a href="#list-of-notifications">list of notifications</a> whose
 <a href="#concept-notification-origin" title="concept-notification-origin">origin</a> is the
 <a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/webappapis.html#entry-settings-object">entry settings object</a>'s
 <a class="external" data-anolis-spec="html" href="https://html.spec.whatwg.org/multipage/browsers.html#origin">origin</a> and whose <a href="#tag">tag</a>, if
 <var title="">tag</var> is not the empty string, is <var title="">tag</var>.
 <span class="XXX">Also check for service worker member.</span>

 <li><p>Let <var title="">objects</var> be an empty JavaScript array.

 <li><p>For each <a href="#concept-notification" title="concept-notification">notification</a> in
 <var title="">notifications</var>, in creation order, create a new
 <a href="#notification"><code>Notification</code></a> object representing
 <a href="#concept-notification" title="concept-notification">notification</a> and push that object to
 <var title="">objects</var>.

 <li><p>Resolve <var title="">promise</var> with <var title="">objects</var>.
</ol>

<p class="note">This method returns zero or more new <a href="#notification"><code>Notification</code></a> objects which
might represent the same underlying <a href="#concept-notification" title="concept-notification">notification</a>
of <a href="#notification"><code>Notification</code></a> objects already in existence.



<h2 class="no-num" id="references">References</h2>

<div id="anolis-references"><dl><dt id="refsBIDI">[BIDI]
<dd><cite><a href="http://www.unicode.org/reports/tr9/">Unicode Bidirectional Algorithm</a></cite>, Mark Davis. Unicode Consortium.

<dt id="refsDOM">[DOM]
<dd><cite><a href="https://dom.spec.whatwg.org/">DOM</a></cite>, Anne van Kesteren, Aryeh Gregor and Ms2ger. WHATWG.

<dt id="refsFETCH">[FETCH]
<dd><cite><a href="https://fetch.spec.whatwg.org/">Fetch</a></cite>, Anne van Kesteren. WHATWG.

<dt id="refsHTML">[HTML]
<dd><cite><a href="https://html.spec.whatwg.org/multipage/">HTML</a></cite>, Ian Hickson. WHATWG.

<dt id="refsLANG">[LANG]
<dd><cite><a href="http://tools.ietf.org/html/bcp47">Tags for Identifying Languages; Matching of Language Tags</a></cite>, Addison Phillips and Mark Davis. IETF.

<dt id="refsRFC2119">[RFC2119]
<dd><cite><a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a></cite>, Scott Bradner. IETF.

<dt id="refsURL">[URL]
<dd><cite><a href="https://url.spec.whatwg.org/">URL</a></cite>, Anne van Kesteren. WHATWG.

<dt id="refsWEBIDL">[WEBIDL]
<dd><cite><a href="http://heycam.github.io/webidl/">Web IDL</a></cite>, Cameron McCormack. W3C.

</dl></div>



<h2 class="no-num" id="acknowledgments">Acknowledgments</h2>

<p>Thanks to
Aharon (Vladimir) Lanin,
Alex Russell,
Arkadiusz Michalski,
David Håsäther,
Doug Turner,
Drew Wilson,
Edward O'Connor,
Frederick Hirsch,
Ian Hickson,
Jake Archibald,
James Graham,
Jon Lee,
Jonas Sicking,
Michael Henretty,
Olli Pettay,
Reuben Morais, and
Simon Pieters
for being awesome.

<p>This standard is written by
<a href="//annevankesteren.nl/" lang="nl">Anne van Kesteren</a>
(<a href="//www.mozilla.org/">Mozilla</a>,
<a href="mailto:annevk@annevk.nl">annevk@annevk.nl</a>). An earlier iteration was written by
John Gregg (<a href="//www.google.com/">Google</a>,
<a href="mailto:johnnyg@google.com">johnnyg@google.com</a>).

<p>Per <a href="//creativecommons.org/publicdomain/zero/1.0/" rel="license">CC0</a>, to
the extent possible under law, the editors have waived all copyright and related or
neighboring rights to this work.

<script id="head" src="//resources.whatwg.org/dfn.js"></script>
